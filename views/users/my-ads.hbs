<div class="adsContainer">
  <div class="passMod">
    <p><a href="usuario/actualizar-clave">Cambiar contraseña</a></p>
  </div>
  {{#each ads as |ad|}}
    <div class="ads">
        <div class="firstRow">
          <div class="ofertaDemanda">{{ad.type}}</div>
          <div class="categoryState">{{ad.category}} en {{ad.city}} ({{ad.state}})</div>
          <div class="reference">r{{ad.reference}}</div>
          <div id="renovate{{ad.reference}}" class="time">{{#date ad.renovate}}{{/date}}</div>
        </div>
        <div class="adBody">
          <div class="adTexts">
            <div class="title"><strong>{{#if ad.brand}}{{ad.brand}} - {{ad.carmodel}}{{/if}}{{ad.title}}</strong></div>
            <div class="description">{{ad.description}}</div>
          </div>
            <div class="adImage">
              <a href="#{{ad.reference}}img"><img class="imgAd" src="{{ad.image.imgPath.[0]}}"/></a>
              <div class="lightboxImg" id="{{ad.reference}}img">
                <figure>
                  <a href="#close" class="close" onclick="myFun2('{{ad.reference}}imgNext', '{{ad.image.imgPath.[0]}}')"></a>
                    <figcaption>
                      <img onclick="myFun('{{ad.reference}}imgNext','{{ad.image.imgPath}}')" class="imgAd" id="{{ad.reference}}imgNext" display="block" src="{{ad.image.imgPath.[0]}}"/>
                    </figcaption>
                </figure>
              </div>
            </div>
        </div>
        <div class="lastrow">
          <div class="adTexts">
            {{!-- <form action="/usuario/renovar/{{ad.id}}" method="POST"> --}}
              <button class="adButton" onclick="renovateMyAds('{{ad.id}}','{{ad.renovate}}', '{{ad.reference}}')">Renovar</button>
            {{!-- </form> --}}
            <a href="/usuario/editar/{{ad.id}}"><button class="adEditButton">Edit</button></a>
            <a href="/usuario/editar-fotos/{{ad.id}}"><button class="adEditButton">Fotos</button></a>
            <a href="#{{ad.reference}}"><button>Borrar</button></a>
            <div class="lightbox" id="{{ad.reference}}">
              <figure>
                <a href="#close" class="close"></a>
                <figcaption>
                  <form action="/usuario/borrar/{{ad.id}}" method="POST">
                    <p>¿Seguro que quieres borrar el anuncio?</p>
                    <button class="adButton">Aceptar</button>
                    <a href="#close"><input type="button" value="Cancelar"></a>
                  </form>
                </figcaption>
              </figure>
            </div>
          </div>
        </div>
    </div>
  {{/each}}
</div>
<script>
  let i = 0;
  //next prev image
  function myFun(ref,str){ 
    const arr = str.split(',');
    const len = arr.length;
    if(i < len - 1){
      i = i + 1;
      document.getElementById(ref).src = arr[i]
    } 
    else {
    i = 0;
    document.getElementById(ref).src = arr[i]
    }
  }
  // close image => count start in 0
  function myFun2(ref,str){ 
    document.getElementById(ref).src = str;
  }    
</script>